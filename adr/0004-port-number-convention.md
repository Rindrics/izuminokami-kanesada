# ADR-0004: ポート番号の規則

## ステータス

承認済み

## コンテキスト

開発環境やローカルサーバーで使用するポート番号を統一する必要がある。

### 要件

1. **衝突回避**: 他のプロジェクトやシステムサービスとの衝突を避ける
2. **一貫性**: プロジェクト内で使用するポート番号を予測可能にする
3. **範囲の明確化**: 使用可能なポート番号の範囲を明示する

## 決定

このプロジェクトでは **30600〜30699** の範囲のポート番号を使用する。

### ポート番号の割り当て

| ポート | 用途 |
| ------ | ---- |
| 30600 | Next.js 開発サーバー |
| 30601 | Firebase Emulator UI |
| 30602 | Firestore Emulator |
| 30603 | Auth Emulator |
| 30604 | Hosting Emulator |
| 30610〜30649 | テスト・検証用（予約） |
| 30650〜30699 | 将来の拡張用（予約） |

### 設定例

#### Next.js

```json
{
  "scripts": {
    "dev": "next dev -p 30600"
  }
}
```

#### Firebase Emulator（firebase.json）

```json
{
  "emulators": {
    "ui": { "port": 30601 },
    "firestore": { "port": 30602 },
    "auth": { "port": 30603 },
    "hosting": { "port": 30604 }
  }
}
```

## 結果

### メリット

1. **衝突リスク低減**: 一般的に使われる 3000, 5000, 8000 番台を避けることで、他プロジェクトとの衝突を回避
2. **識別性**: 30600 番台を見れば本プロジェクトとすぐに判別可能
3. **拡張性**: 100 ポートの範囲があり、将来の拡張に対応可能

### 考慮事項

1. **ドキュメント**: 新しいサービスを追加する際は、このドキュメントを更新する
2. **環境変数**: 必要に応じて環境変数でオーバーライド可能にする
