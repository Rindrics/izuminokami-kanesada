import type { KunyomiEntry } from '@/types/content';

export const kunyomiDictionary: KunyomiEntry[] = [
  {
    id: '子',
    text: '子',
    readings: [
      { id: '子-し', ruby: 'し', is_default: true, note: '敬称' },
      { id: '子-こ', ruby: 'こ', is_default: false, note: '子供' },
    ],
  },
  {
    id: '曰',
    text: '曰',
    readings: [
      { id: '曰-いわ', ruby: 'いわ', okurigana: 'く', is_default: true },
      { id: '曰-のたま', ruby: 'のたま', okurigana: 'わく', is_default: false },
    ],
  },
  {
    id: '学',
    text: '学',
    readings: [
      { id: '学-まな', ruby: 'まな', okurigana: 'ぶ', is_default: true },
    ],
  },
  {
    id: '時',
    text: '時',
    readings: [{ id: '時-とき', ruby: 'とき', is_default: true }],
  },
  {
    id: '之',
    text: '之',
    readings: [{ id: '之-これ', ruby: 'これ', is_default: true }],
  },
  {
    id: '習',
    text: '習',
    readings: [
      { id: '習-なら', ruby: 'なら', okurigana: 'う', is_default: true },
    ],
  },
  {
    id: '亦',
    text: '亦',
    readings: [{ id: '亦-ま', ruby: 'ま', okurigana: 'た', is_default: true }],
  },
  {
    id: '説',
    text: '説',
    readings: [
      { id: '説-よろこ', ruby: 'よろこ', okurigana: 'ぶ', is_default: true },
      { id: '説-と', ruby: 'と', okurigana: 'く', is_default: false },
    ],
  },
  {
    id: '朋',
    text: '朋',
    readings: [{ id: '朋-とも', ruby: 'とも', is_default: true }],
  },
  {
    id: '遠方',
    text: '遠方',
    readings: [{ id: '遠方-えんぽう', ruby: 'えんぽう', is_default: true }],
  },
  {
    id: '来',
    text: '来',
    readings: [
      { id: '来-きた', ruby: 'きた', okurigana: 'る', is_default: true },
    ],
  },
  {
    id: '有',
    text: '有',
    readings: [{ id: '有-あ', ruby: 'あ', okurigana: 'り', is_default: true }],
  },
  {
    id: '有子',
    text: '有子',
    readings: [{ id: '有子-ゆうし', ruby: 'ゆうし', is_default: true }],
  },
  {
    id: '楽',
    text: '楽',
    readings: [
      { id: '楽-たの', ruby: 'たの', okurigana: 'しい', is_default: true },
    ],
  },
  {
    id: '人',
    text: '人',
    readings: [{ id: '人-ひと', ruby: 'ひと', is_default: true }],
  },
  {
    id: '知',
    text: '知',
    readings: [{ id: '知-し', ruby: 'し', okurigana: 'る', is_default: true }],
  },
  {
    id: '慍',
    text: '慍',
    readings: [
      {
        id: '慍-いか',
        ruby: 'いか',
        okurigana: 'る',
        is_default: true,
      },
      { id: '慍-うら', ruby: 'うら', okurigana: 'む', is_default: false },
    ],
  },
  {
    id: '君子',
    text: '君子',
    readings: [{ id: '君子-くんし', ruby: 'くんし', is_default: true }],
  },
  {
    id: '時習',
    text: '時習',
    readings: [{ id: '時習-じしゅう', ruby: 'じしゅう', is_default: true }],
  },
  {
    id: '其',
    text: '其',
    readings: [{ id: '其-そ', ruby: 'そ', okurigana: 'の', is_default: true }],
  },
  {
    id: '為',
    text: '為',
    readings: [
      { id: '為-な', ruby: 'な', okurigana: 'り', is_default: true },
      { id: '為-ため', ruby: 'ため', is_default: false },
    ],
  },
  {
    id: '孝弟',
    text: '孝弟',
    readings: [{ id: '孝弟-こうてい', ruby: 'こうてい', is_default: true }],
  },
  {
    id: '上',
    text: '上',
    readings: [
      { id: '上-かみ', ruby: 'かみ', is_default: true },
      { id: '上-うえ', ruby: 'うえ', is_default: false },
    ],
  },
  {
    id: '犯',
    text: '犯',
    readings: [
      { id: '犯-おか', ruby: 'おか', okurigana: 'す', is_default: true },
    ],
  },
  {
    id: '好',
    text: '好',
    readings: [
      { id: '好-この', ruby: 'この', okurigana: 'む', is_default: true },
    ],
  },
  {
    id: '者',
    text: '者',
    readings: [{ id: '者-もの', ruby: 'もの', is_default: true }],
  },
  {
    id: '鮮',
    text: '鮮',
    readings: [
      { id: '鮮-すくな', ruby: 'すくな', okurigana: 'し', is_default: true },
    ],
  },
  {
    id: '乱',
    text: '乱',
    readings: [
      { id: '乱-らん', ruby: 'らん', is_default: true },
      { id: '乱-みだ', ruby: 'みだ', okurigana: 'れ', is_default: false },
    ],
  },
  {
    id: '作',
    text: '作',
    readings: [
      { id: '作-な', ruby: 'な', okurigana: 'す', is_default: true },
      { id: '作-つく', ruby: 'つく', okurigana: 'る', is_default: false },
    ],
  },
  {
    id: '未',
    text: '未',
    readings: [
      { id: '未-いま', ruby: 'いま', okurigana: 'だ', is_default: true },
    ],
  },
  {
    id: '本',
    text: '本',
    readings: [{ id: '本-もと', ruby: 'もと', is_default: true }],
  },
  {
    id: '務',
    text: '務',
    readings: [
      { id: '務-つと', ruby: 'つと', okurigana: 'む', is_default: true },
    ],
  },
  {
    id: '立',
    text: '立',
    readings: [{ id: '立-た', ruby: 'た', okurigana: 'つ', is_default: true }],
  },
  {
    id: '道',
    text: '道',
    readings: [{ id: '道-みち', ruby: 'みち', is_default: true }],
  },
  {
    id: '生',
    text: '生',
    readings: [
      { id: '生-しょう', ruby: 'しょう', okurigana: 'ず', is_default: true },
      { id: '生-う', ruby: 'う', okurigana: 'まれる', is_default: false },
    ],
  },
  {
    id: '仁',
    text: '仁',
    readings: [{ id: '仁-じん', ruby: 'じん', is_default: true }],
  },
  {
    id: '巧',
    text: '巧',
    readings: [{ id: '巧-たく', ruby: 'たく', is_default: true }],
  },
  {
    id: '省',
    text: '省',
    readings: [{ id: '省-かえり', ruby: 'かえり', is_default: true }],
  },
  {
    id: '言',
    text: '言',
    readings: [{ id: '言-げん', ruby: 'げん', is_default: true }],
  },
  {
    id: '謀',
    text: '謀',
    readings: [{ id: '謀-はか', ruby: 'はか', is_default: true }],
  },
  {
    id: '令',
    text: '令',
    readings: [{ id: '令-れい', ruby: 'れい', is_default: true }],
  },
  {
    id: '忠',
    text: '忠',
    readings: [{ id: '忠-ちゅう', ruby: 'ちゅう', is_default: true }],
  },
  {
    id: '色',
    text: '色',
    readings: [{ id: '色-しょく', ruby: 'しょく', is_default: true }],
  },
  {
    id: '曾',
    text: '曾',
    readings: [{ id: '曾-そう', ruby: 'そう', is_default: true }],
  },
  {
    id: '吾',
    text: '吾',
    readings: [{ id: '吾-われ', ruby: 'われ', is_default: true }],
  },
  {
    id: '日',
    text: '日',
    readings: [{ id: '日-ひ', ruby: 'ひ', is_default: true }],
  },
  {
    id: '三',
    text: '三',
    readings: [{ id: '三-み', ruby: 'み', is_default: true }],
  },
  {
    id: '身',
    text: '身',
    readings: [{ id: '身-み', ruby: 'み', is_default: true }],
  },
  {
    id: '友',
    text: '友',
    readings: [{ id: '友-とも', ruby: 'とも', is_default: true }],
  },
  {
    id: '交',
    text: '交',
    readings: [{ id: '交-まじ', ruby: 'まじ', is_default: true }],
  },
  {
    id: '信',
    text: '信',
    readings: [{ id: '信-しん', ruby: 'しん', is_default: true }],
  },
  {
    id: '伝',
    text: '伝',
    readings: [{ id: '伝-つた', ruby: 'つた', is_default: true }],
  },
  {
    id: '千',
    text: '千',
    readings: [{ id: '千-せん', ruby: 'せん', is_default: true }],
  },
  {
    id: '乗',
    text: '乗',
    readings: [{ id: '乗-じょう', ruby: 'じょう', is_default: true }],
  },
  {
    id: '国',
    text: '国',
    readings: [{ id: '国-くに', ruby: 'くに', is_default: true }],
  },
  {
    id: '事',
    text: '事',
    readings: [{ id: '事-こと', ruby: 'こと', is_default: true }],
  },
  {
    id: '敬',
    text: '敬',
    readings: [{ id: '敬-つつし', ruby: 'つつし', is_default: true }],
  },
  {
    id: '用',
    text: '用',
    readings: [{ id: '用-よう', ruby: 'よう', is_default: true }],
  },
  {
    id: '節',
    text: '節',
    readings: [{ id: '節-せっ', ruby: 'せっ', is_default: true }],
  },
  {
    id: '愛',
    text: '愛',
    readings: [{ id: '愛-あい', ruby: 'あい', is_default: true }],
  },
  {
    id: '民',
    text: '民',
    readings: [{ id: '民-たみ', ruby: 'たみ', is_default: true }],
  },
  {
    id: '使',
    text: '使',
    readings: [{ id: '使-つか', ruby: 'つか', is_default: true }],
  },
  {
    id: '以',
    text: '以',
    readings: [{ id: '以-もっ', ruby: 'もっ', is_default: true }],
  },
  {
    id: '入',
    text: '入',
    readings: [{ id: '入-い', ruby: 'い', is_default: true }],
  },
  {
    id: '則',
    text: '則',
    readings: [{ id: '則-すなわ', ruby: 'すなわ', is_default: true }],
  },
  {
    id: '出',
    text: '出',
    readings: [{ id: '出-い', ruby: 'い', is_default: true }],
  },
  {
    id: '謹',
    text: '謹',
    readings: [{ id: '謹-つつし', ruby: 'つつし', is_default: true }],
  },
  {
    id: '汎',
    text: '汎',
    readings: [{ id: '汎-ひろ', ruby: 'ひろ', is_default: true }],
  },
  {
    id: '衆',
    text: '衆',
    readings: [{ id: '衆-しゅう', ruby: 'しゅう', is_default: true }],
  },
  {
    id: '親',
    text: '親',
    readings: [{ id: '親-した', ruby: 'した', is_default: true }],
  },
  {
    id: '行',
    text: '行',
    readings: [{ id: '行-おこな', ruby: 'おこな', is_default: true }],
  },
  {
    id: '余',
    text: '余',
    readings: [{ id: '余-よ', ruby: 'よ', is_default: true }],
  },
  {
    id: '力',
    text: '力',
    readings: [{ id: '力-ちから', ruby: 'ちから', is_default: true }],
  },
  {
    id: '文',
    text: '文',
    readings: [{ id: '文-ぶん', ruby: 'ぶん', is_default: true }],
  },
];

export function getKunyomiEntry(text: string): KunyomiEntry | undefined {
  return kunyomiDictionary.find((e) => e.text === text);
}

export function getDefaultReading(text: string): string | undefined {
  const entry = getKunyomiEntry(text);
  if (!entry) return undefined;
  const defaultReading = entry.readings.find((r) => r.is_default);
  return defaultReading?.ruby;
}

// Find longest matching entry starting at position in text
// Returns { text, ruby, length } or undefined
export function findLongestMatch(
  fullText: string,
  startPos: number,
): { text: string; ruby: string; length: number } | undefined {
  // Try longer matches first (up to 4 characters for compound words)
  for (let len = 4; len >= 1; len--) {
    const substr = fullText.slice(startPos, startPos + len);
    if (substr.length < len) continue;

    const reading = getDefaultReading(substr);
    if (reading) {
      return { text: substr, ruby: reading, length: len };
    }
  }
  return undefined;
}
